# =========================================================================================
# ADOPTION POTENTIAL OUTPUT FOR CLAUDE TO REVIEW AND DEBUG
# =========================================================================================


# =========================================================================================
# SCENARIO ANALYSIS (NO INFLATION REDUCTION ACT): ADOPTION POTENTIAL
# =========================================================================================


========================================================================================= FUNCTION CALL =========================================================================================


# ========================== AP2  ========================== 
df_euss_am_mp8_home_ap2 = adoption_decision(
    df=df_euss_am_mp8_home_ap2,
    menu_mp=menu_mp,
    policy_scenario='No Inflation Reduction Act',
    rcm_model='ap2',
    cr_function='acs',
    )

df_euss_am_mp8_home_ap2 = adoption_decision(
    df=df_euss_am_mp8_home_ap2,
    menu_mp=menu_mp,
    policy_scenario='No Inflation Reduction Act',
    rcm_model='ap2',
    cr_function='h6c',
    )

# ====================== EASIUR ========================== 
df_euss_am_mp8_home_easiur = adoption_decision(
    df=df_euss_am_mp8_home_easiur,
    menu_mp=menu_mp,
    policy_scenario='No Inflation Reduction Act',
    rcm_model='easiur',
    cr_function='acs',
    )

df_euss_am_mp8_home_easiur = adoption_decision(
    df=df_euss_am_mp8_home_easiur,
    menu_mp=menu_mp,
    policy_scenario='No Inflation Reduction Act',
    rcm_model='easiur',
    cr_function='h6c',
    )

# ====================== InMAP ========================== 
df_euss_am_mp8_home_inmap = adoption_decision(
    df=df_euss_am_mp8_home_inmap,
    menu_mp=menu_mp,
    policy_scenario='No Inflation Reduction Act',
    rcm_model='inmap',
    cr_function='acs',
    )

df_euss_am_mp8_home_inmap = adoption_decision(
    df=df_euss_am_mp8_home_inmap,
    menu_mp=menu_mp,
    policy_scenario='No Inflation Reduction Act',
    rcm_model='inmap',
    cr_function='h6c',
    )


print(f"""
====================================================================================================================================================================
DATAFRAME FOR MP8 AFTER DETERMINING ADOPTION FEASIBILITY (NO INFLATION REDUCTION ACT): df_euss_am_mp8_home

-----------------------------------------------
AP2: 
-----------------------------------------------

{df_euss_am_mp8_home_ap2}

-----------------------------------------------
EASIUR:
-----------------------------------------------

{df_euss_am_mp8_home_easiur}

-----------------------------------------------
InMAP:
-----------------------------------------------

{df_euss_am_mp8_home_inmap}
      
""")


========================================================================================= OUTPUT =========================================================================================



====================================================================================================================================================================
SCENARIO ANALYSIS (NO INFLATION REDUCTION ACT): ADOPTION POTENTIAL
====================================================================================================================================================================
determine_adoption_potential.py file contains the definition for the adoption_decision function.
      
RESULTS OUTPUT (NO INFLATION REDUCTION ACT):

-- Scenario: No Inflation Reduction Act -- 
              scenario_prefix: f'preIRA_mp8_', cambium_scenario: 'MidCase', lookup_emissions_fossil_fuel: 'lookup_emissions_fossil_fuel', 
              lookup_emissions_electricity_climate: 'lookup_emissions_electricity_climate_preIRA', lookup_emissions_electricity_health: 'lookup_emissions_electricity_health', lookup_fuel_prices: 'lookup_fuel_prices_preIRA'
              

Calculating Adoption Potential for heating under 'No Inflation Reduction Act' Scenario...
Measure package calculation for heating:
  - 12266 homes have valid data
  - 15649 homes will receive retrofits
  - 12266 homes have both valid data AND will receive retrofits
  - 3385 homes excluded (values will be NaN)
Found 12266 valid homes out of 15651 for heating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_heating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_heating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_heating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs

Calculating Adoption Potential for waterHeating under 'No Inflation Reduction Act' Scenario...
Measure package calculation for waterHeating:
  - 14999 homes have valid data
  - 15551 homes will receive retrofits
  - 14999 homes have both valid data AND will receive retrofits
  - 652 homes excluded (values will be NaN)
Found 14999 valid homes out of 15651 for waterHeating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_waterHeating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_waterHeating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_waterHeating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs

Calculating Adoption Potential for clothesDrying under 'No Inflation Reduction Act' Scenario...
Measure package calculation for clothesDrying:
  - 14743 homes have valid data
  - 14743 homes will receive retrofits
  - 14743 homes have both valid data AND will receive retrofits
  - 908 homes excluded (values will be NaN)
Found 14743 valid homes out of 15651 for clothesDrying adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_clothesDrying_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_clothesDrying_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_clothesDrying_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs

Calculating Adoption Potential for cooking under 'No Inflation Reduction Act' Scenario...
Measure package calculation for cooking:
  - 7867 homes have valid data
  - 7867 homes will receive retrofits
  - 7867 homes have both valid data AND will receive retrofits
  - 7784 homes excluded (values will be NaN)
Found 7867 valid homes out of 15651 for cooking adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_cooking_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_cooking_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_cooking_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs

Verifying masking for all calculated columns:
Masking 120 columns for category 'cooking'
    preIRA_mp8_cooking_health_sensitivity: Masked 7784 values
    preIRA_mp8_cooking_adoption_lower_ap2_acs: Masked 7784 values
    preIRA_mp8_cooking_impact_lower_ap2_acs: Masked 7784 values
    preIRA_mp8_cooking_adoption_healthOnly_ap2_acs: Masked 7784 values
    preIRA_mp8_cooking_impact_healthOnly_ap2_acs: Masked 7784 values
    preIRA_mp8_cooking_adoption_central_ap2_acs: Masked 7784 values
    preIRA_mp8_cooking_impact_central_ap2_acs: Masked 7784 values
    preIRA_mp8_cooking_adoption_upper_ap2_acs: Masked 7784 values
    preIRA_mp8_cooking_impact_upper_ap2_acs: Masked 7784 values
  Total: Masked 70056 values across 120 columns
-- Scenario: No Inflation Reduction Act -- 
              scenario_prefix: f'preIRA_mp8_', cambium_scenario: 'MidCase', lookup_emissions_fossil_fuel: 'lookup_emissions_fossil_fuel', 
              lookup_emissions_electricity_climate: 'lookup_emissions_electricity_climate_preIRA', lookup_emissions_electricity_health: 'lookup_emissions_electricity_health', lookup_fuel_prices: 'lookup_fuel_prices_preIRA'
              

Calculating Adoption Potential for heating under 'No Inflation Reduction Act' Scenario...
Measure package calculation for heating:
  - 12266 homes have valid data
  - 15649 homes will receive retrofits
  - 12266 homes have both valid data AND will receive retrofits
  - 3385 homes excluded (values will be NaN)
Found 12266 valid homes out of 15651 for heating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_heating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_heating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_heating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c

Calculating Adoption Potential for waterHeating under 'No Inflation Reduction Act' Scenario...
Measure package calculation for waterHeating:
  - 14999 homes have valid data
  - 15551 homes will receive retrofits
  - 14999 homes have both valid data AND will receive retrofits
  - 652 homes excluded (values will be NaN)
Found 14999 valid homes out of 15651 for waterHeating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_waterHeating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_waterHeating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_waterHeating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c

Calculating Adoption Potential for clothesDrying under 'No Inflation Reduction Act' Scenario...
Measure package calculation for clothesDrying:
  - 14743 homes have valid data
  - 14743 homes will receive retrofits
  - 14743 homes have both valid data AND will receive retrofits
  - 908 homes excluded (values will be NaN)
Found 14743 valid homes out of 15651 for clothesDrying adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_clothesDrying_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_clothesDrying_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_clothesDrying_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c

Calculating Adoption Potential for cooking under 'No Inflation Reduction Act' Scenario...
Measure package calculation for cooking:
  - 7867 homes have valid data
  - 7867 homes will receive retrofits
  - 7867 homes have both valid data AND will receive retrofits
  - 7784 homes excluded (values will be NaN)
Found 7867 valid homes out of 15651 for cooking adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_cooking_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_cooking_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_cooking_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c

Verifying masking for all calculated columns:
Masking 120 columns for category 'cooking'
    preIRA_mp8_cooking_health_sensitivity: Masked 7784 values
    preIRA_mp8_cooking_adoption_lower_ap2_h6c: Masked 7784 values
    preIRA_mp8_cooking_impact_lower_ap2_h6c: Masked 7784 values
    preIRA_mp8_cooking_adoption_healthOnly_ap2_h6c: Masked 7784 values
    preIRA_mp8_cooking_impact_healthOnly_ap2_h6c: Masked 7784 values
    preIRA_mp8_cooking_adoption_central_ap2_h6c: Masked 7784 values
    preIRA_mp8_cooking_impact_central_ap2_h6c: Masked 7784 values
    preIRA_mp8_cooking_adoption_upper_ap2_h6c: Masked 7784 values
    preIRA_mp8_cooking_impact_upper_ap2_h6c: Masked 7784 values
  Total: Masked 70056 values across 120 columns
-- Scenario: No Inflation Reduction Act -- 
              scenario_prefix: f'preIRA_mp8_', cambium_scenario: 'MidCase', lookup_emissions_fossil_fuel: 'lookup_emissions_fossil_fuel', 
              lookup_emissions_electricity_climate: 'lookup_emissions_electricity_climate_preIRA', lookup_emissions_electricity_health: 'lookup_emissions_electricity_health', lookup_fuel_prices: 'lookup_fuel_prices_preIRA'
              

Calculating Adoption Potential for heating under 'No Inflation Reduction Act' Scenario...
Measure package calculation for heating:
  - 12266 homes have valid data
  - 15649 homes will receive retrofits
  - 12266 homes have both valid data AND will receive retrofits
  - 3385 homes excluded (values will be NaN)
Found 12266 valid homes out of 15651 for heating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_heating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_heating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_heating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs

Calculating Adoption Potential for waterHeating under 'No Inflation Reduction Act' Scenario...
Measure package calculation for waterHeating:
  - 14999 homes have valid data
  - 15551 homes will receive retrofits
  - 14999 homes have both valid data AND will receive retrofits
  - 652 homes excluded (values will be NaN)
Found 14999 valid homes out of 15651 for waterHeating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_waterHeating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_waterHeating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_waterHeating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs

Calculating Adoption Potential for clothesDrying under 'No Inflation Reduction Act' Scenario...
Measure package calculation for clothesDrying:
  - 14743 homes have valid data
  - 14743 homes will receive retrofits
  - 14743 homes have both valid data AND will receive retrofits
  - 908 homes excluded (values will be NaN)
Found 14743 valid homes out of 15651 for clothesDrying adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_clothesDrying_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_clothesDrying_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_clothesDrying_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs

Calculating Adoption Potential for cooking under 'No Inflation Reduction Act' Scenario...
Measure package calculation for cooking:
  - 7867 homes have valid data
  - 7867 homes will receive retrofits
  - 7867 homes have both valid data AND will receive retrofits
  - 7784 homes excluded (values will be NaN)
Found 7867 valid homes out of 15651 for cooking adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_cooking_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_cooking_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_cooking_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs

Verifying masking for all calculated columns:
Masking 120 columns for category 'cooking'
    preIRA_mp8_cooking_health_sensitivity: Masked 7784 values
    preIRA_mp8_cooking_adoption_lower_easiur_acs: Masked 7784 values
    preIRA_mp8_cooking_impact_lower_easiur_acs: Masked 7784 values
    preIRA_mp8_cooking_adoption_healthOnly_easiur_acs: Masked 7784 values
    preIRA_mp8_cooking_impact_healthOnly_easiur_acs: Masked 7784 values
    preIRA_mp8_cooking_adoption_central_easiur_acs: Masked 7784 values
    preIRA_mp8_cooking_impact_central_easiur_acs: Masked 7784 values
    preIRA_mp8_cooking_adoption_upper_easiur_acs: Masked 7784 values
    preIRA_mp8_cooking_impact_upper_easiur_acs: Masked 7784 values
  Total: Masked 70056 values across 120 columns
-- Scenario: No Inflation Reduction Act -- 
              scenario_prefix: f'preIRA_mp8_', cambium_scenario: 'MidCase', lookup_emissions_fossil_fuel: 'lookup_emissions_fossil_fuel', 
              lookup_emissions_electricity_climate: 'lookup_emissions_electricity_climate_preIRA', lookup_emissions_electricity_health: 'lookup_emissions_electricity_health', lookup_fuel_prices: 'lookup_fuel_prices_preIRA'
              

Calculating Adoption Potential for heating under 'No Inflation Reduction Act' Scenario...
Measure package calculation for heating:
  - 12266 homes have valid data
  - 15649 homes will receive retrofits
  - 12266 homes have both valid data AND will receive retrofits
  - 3385 homes excluded (values will be NaN)
Found 12266 valid homes out of 15651 for heating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_heating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_heating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_heating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c

Calculating Adoption Potential for waterHeating under 'No Inflation Reduction Act' Scenario...
Measure package calculation for waterHeating:
  - 14999 homes have valid data
  - 15551 homes will receive retrofits
  - 14999 homes have both valid data AND will receive retrofits
  - 652 homes excluded (values will be NaN)
Found 14999 valid homes out of 15651 for waterHeating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_waterHeating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_waterHeating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_waterHeating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c

Calculating Adoption Potential for clothesDrying under 'No Inflation Reduction Act' Scenario...
Measure package calculation for clothesDrying:
  - 14743 homes have valid data
  - 14743 homes will receive retrofits
  - 14743 homes have both valid data AND will receive retrofits
  - 908 homes excluded (values will be NaN)
Found 14743 valid homes out of 15651 for clothesDrying adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_clothesDrying_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_clothesDrying_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_clothesDrying_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c

Calculating Adoption Potential for cooking under 'No Inflation Reduction Act' Scenario...
Measure package calculation for cooking:
  - 7867 homes have valid data
  - 7867 homes will receive retrofits
  - 7867 homes have both valid data AND will receive retrofits
  - 7784 homes excluded (values will be NaN)
Found 7867 valid homes out of 15651 for cooking adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_cooking_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_cooking_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_cooking_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c

Verifying masking for all calculated columns:
Masking 120 columns for category 'cooking'
    preIRA_mp8_cooking_health_sensitivity: Masked 7784 values
    preIRA_mp8_cooking_adoption_lower_easiur_h6c: Masked 7784 values
    preIRA_mp8_cooking_impact_lower_easiur_h6c: Masked 7784 values
    preIRA_mp8_cooking_adoption_healthOnly_easiur_h6c: Masked 7784 values
    preIRA_mp8_cooking_impact_healthOnly_easiur_h6c: Masked 7784 values
    preIRA_mp8_cooking_adoption_central_easiur_h6c: Masked 7784 values
    preIRA_mp8_cooking_impact_central_easiur_h6c: Masked 7784 values
    preIRA_mp8_cooking_adoption_upper_easiur_h6c: Masked 7784 values
    preIRA_mp8_cooking_impact_upper_easiur_h6c: Masked 7784 values
  Total: Masked 70056 values across 120 columns
-- Scenario: No Inflation Reduction Act -- 
              scenario_prefix: f'preIRA_mp8_', cambium_scenario: 'MidCase', lookup_emissions_fossil_fuel: 'lookup_emissions_fossil_fuel', 
              lookup_emissions_electricity_climate: 'lookup_emissions_electricity_climate_preIRA', lookup_emissions_electricity_health: 'lookup_emissions_electricity_health', lookup_fuel_prices: 'lookup_fuel_prices_preIRA'
              

Calculating Adoption Potential for heating under 'No Inflation Reduction Act' Scenario...
Measure package calculation for heating:
  - 12266 homes have valid data
  - 15649 homes will receive retrofits
  - 12266 homes have both valid data AND will receive retrofits
  - 3385 homes excluded (values will be NaN)
Found 12266 valid homes out of 15651 for heating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_heating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_heating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_heating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs

Calculating Adoption Potential for waterHeating under 'No Inflation Reduction Act' Scenario...
Measure package calculation for waterHeating:
  - 14999 homes have valid data
  - 15551 homes will receive retrofits
  - 14999 homes have both valid data AND will receive retrofits
  - 652 homes excluded (values will be NaN)
Found 14999 valid homes out of 15651 for waterHeating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_waterHeating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_waterHeating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_waterHeating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs

Calculating Adoption Potential for clothesDrying under 'No Inflation Reduction Act' Scenario...
Measure package calculation for clothesDrying:
  - 14743 homes have valid data
  - 14743 homes will receive retrofits
  - 14743 homes have both valid data AND will receive retrofits
  - 908 homes excluded (values will be NaN)
Found 14743 valid homes out of 15651 for clothesDrying adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_clothesDrying_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_clothesDrying_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_clothesDrying_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs

Calculating Adoption Potential for cooking under 'No Inflation Reduction Act' Scenario...
Measure package calculation for cooking:
  - 7867 homes have valid data
  - 7867 homes will receive retrofits
  - 7867 homes have both valid data AND will receive retrofits
  - 7784 homes excluded (values will be NaN)
Found 7867 valid homes out of 15651 for cooking adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_cooking_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_cooking_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_cooking_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs

Verifying masking for all calculated columns:
Masking 120 columns for category 'cooking'
    preIRA_mp8_cooking_health_sensitivity: Masked 7784 values
    preIRA_mp8_cooking_adoption_lower_inmap_acs: Masked 7784 values
    preIRA_mp8_cooking_impact_lower_inmap_acs: Masked 7784 values
    preIRA_mp8_cooking_adoption_healthOnly_inmap_acs: Masked 7784 values
    preIRA_mp8_cooking_impact_healthOnly_inmap_acs: Masked 7784 values
    preIRA_mp8_cooking_adoption_central_inmap_acs: Masked 7784 values
    preIRA_mp8_cooking_impact_central_inmap_acs: Masked 7784 values
    preIRA_mp8_cooking_adoption_upper_inmap_acs: Masked 7784 values
    preIRA_mp8_cooking_impact_upper_inmap_acs: Masked 7784 values
  Total: Masked 70056 values across 120 columns
-- Scenario: No Inflation Reduction Act -- 
              scenario_prefix: f'preIRA_mp8_', cambium_scenario: 'MidCase', lookup_emissions_fossil_fuel: 'lookup_emissions_fossil_fuel', 
              lookup_emissions_electricity_climate: 'lookup_emissions_electricity_climate_preIRA', lookup_emissions_electricity_health: 'lookup_emissions_electricity_health', lookup_fuel_prices: 'lookup_fuel_prices_preIRA'
              

Calculating Adoption Potential for heating under 'No Inflation Reduction Act' Scenario...
Measure package calculation for heating:
  - 12266 homes have valid data
  - 15649 homes will receive retrofits
  - 12266 homes have both valid data AND will receive retrofits
  - 3385 homes excluded (values will be NaN)
Found 12266 valid homes out of 15651 for heating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_heating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_heating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_heating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c

Calculating Adoption Potential for waterHeating under 'No Inflation Reduction Act' Scenario...
Measure package calculation for waterHeating:
  - 14999 homes have valid data
  - 15551 homes will receive retrofits
  - 14999 homes have both valid data AND will receive retrofits
  - 652 homes excluded (values will be NaN)
Found 14999 valid homes out of 15651 for waterHeating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_waterHeating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_waterHeating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_waterHeating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c

Calculating Adoption Potential for clothesDrying under 'No Inflation Reduction Act' Scenario...
Measure package calculation for clothesDrying:
  - 14743 homes have valid data
  - 14743 homes will receive retrofits
  - 14743 homes have both valid data AND will receive retrofits
  - 908 homes excluded (values will be NaN)
Found 14743 valid homes out of 15651 for clothesDrying adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_clothesDrying_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_clothesDrying_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_clothesDrying_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c

Calculating Adoption Potential for cooking under 'No Inflation Reduction Act' Scenario...
Measure package calculation for cooking:
  - 7867 homes have valid data
  - 7867 homes will receive retrofits
  - 7867 homes have both valid data AND will receive retrofits
  - 7784 homes excluded (values will be NaN)
Found 7867 valid homes out of 15651 for cooking adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_cooking_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_cooking_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['preIRA_mp8_cooking_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c

Verifying masking for all calculated columns:
Masking 120 columns for category 'cooking'
    preIRA_mp8_cooking_health_sensitivity: Masked 7784 values
    preIRA_mp8_cooking_adoption_lower_inmap_h6c: Masked 7784 values
    preIRA_mp8_cooking_impact_lower_inmap_h6c: Masked 7784 values
    preIRA_mp8_cooking_adoption_healthOnly_inmap_h6c: Masked 7784 values
    preIRA_mp8_cooking_impact_healthOnly_inmap_h6c: Masked 7784 values
    preIRA_mp8_cooking_adoption_central_inmap_h6c: Masked 7784 values
    preIRA_mp8_cooking_impact_central_inmap_h6c: Masked 7784 values
    preIRA_mp8_cooking_adoption_upper_inmap_h6c: Masked 7784 values
    preIRA_mp8_cooking_impact_upper_inmap_h6c: Masked 7784 values
  Total: Masked 70056 values across 120 columns

====================================================================================================================================================================
DATAFRAME FOR MP8 AFTER DETERMINING ADOPTION FEASIBILITY (NO INFLATION REDUCTION ACT): df_euss_am_mp8_home

-----------------------------------------------
AP2: 
-----------------------------------------------

         square_footage census_region  census_division census_division_recs  \
bldg_id                                                                       
119              2152.0     Northeast  Middle Atlantic      Middle Atlantic   
122              2176.0     Northeast  Middle Atlantic      Middle Atlantic   
150              1690.0     Northeast  Middle Atlantic      Middle Atlantic   
153              2176.0     Northeast  Middle Atlantic      Middle Atlantic   
162              2663.0     Northeast  Middle Atlantic      Middle Atlantic   
...                 ...           ...              ...                  ...   
549882           1202.0     Northeast  Middle Atlantic      Middle Atlantic   
549915           2176.0     Northeast  Middle Atlantic      Middle Atlantic   
549937            885.0     Northeast  Middle Atlantic      Middle Atlantic   
549963           1690.0     Northeast  Middle Atlantic      Middle Atlantic   
549989           1220.0     Northeast  Middle Atlantic      Middle Atlantic   

        building_america_climate_zone  reeds_balancing_area gea_region state  \
bldg_id                                                                        
119                       Mixed-Humid                   122      RFCEc    PA   
122                       Mixed-Humid                   122      RFCEc    PA   
150                              Cold                   122      RFCEc    PA   
153                       Mixed-Humid                   122      RFCEc    PA   
162                       Mixed-Humid                   122      RFCEc    PA   
...                               ...                   ...        ...   ...   
549882                           Cold                   122      RFCEc    PA   
549915                           Cold                   122      RFCEc    PA   
549937                           Cold                   115      RFCWc    PA   
549963                           Cold                   115      RFCWc    PA   
549989                           Cold                   122      RFCEc    PA   

                            city    county  ...  \
bldg_id                                     ...   
119        Not in a census Place  G4200450  ...   
122      In another census Place  G4200450  ...   
150      In another census Place  G4201190  ...   
153        Not in a census Place  G4200170  ...   
162        Not in a census Place  G4200450  ...   
...                          ...       ...  ...   
549882     Not in a census Place  G4200110  ...   
549915                 Lancaster  G4200710  ...   
549937   In another census Place  G4200050  ...   
549963   In another census Place  G4201290  ...   
549989     Not in a census Place  G4201110  ...   

        preIRA_mp8_cooking_health_sensitivity  \
bldg_id                                         
119                                  ap2, h6c   
122                                       NaN   
150                                       NaN   
153                                       NaN   
162                                       NaN   
...                                       ...   
549882                                    NaN   
549915                                    NaN   
549937                               ap2, h6c   
549963                                    NaN   
549989                               ap2, h6c   

        preIRA_mp8_cooking_benefit_upper_ap2_h6c  \
bldg_id                                            
119                                          0.0   
122                                          NaN   
150                                          NaN   
153                                          NaN   
162                                          NaN   
...                                          ...   
549882                                       NaN   
549915                                       NaN   
549937                                       0.0   
549963                                       NaN   
549989                                       0.0   

        preIRA_mp8_cooking_total_npv_lessWTP_upper_ap2_h6c  \
bldg_id                                                      
119                                               -1724.90   
122                                                    NaN   
150                                                    NaN   
153                                                    NaN   
162                                                    NaN   
...                                                    ...   
549882                                                 NaN   
549915                                                 NaN   
549937                                            -3510.40   
549963                                                 NaN   
549989                                            -1799.85   

        preIRA_mp8_cooking_total_npv_moreWTP_upper_ap2_h6c  \
bldg_id                                                      
119                                                -652.36   
122                                                    NaN   
150                                                    NaN   
153                                                    NaN   
162                                                    NaN   
...                                                    ...   
549882                                                 NaN   
549915                                                 NaN   
549937                                            -2437.86   
549963                                                 NaN   
549989                                             -727.31   

         preIRA_mp8_cooking_adoption_upper_ap2_h6c  \
bldg_id                                              
119                                 Tier 4: Averse   
122                                            NaN   
150                                            NaN   
153                                            NaN   
162                                            NaN   
...                                            ...   
549882                                         NaN   
549915                                         NaN   
549937                              Tier 4: Averse   
549963                                         NaN   
549989                              Tier 4: Averse   

         preIRA_mp8_cooking_impact_upper_ap2_h6c  \
bldg_id                                            
119                             Public Detriment   
122                                          NaN   
150                                          NaN   
153                                          NaN   
162                                          NaN   
...                                          ...   
549882                                       NaN   
549915                                       NaN   
549937                          Public Detriment   
549963                                       NaN   
549989                            Public Benefit   

        preIRA_mp8_cooking_total_npv_lessWTP_healthOnly_ap2_h6c  \
bldg_id                                                           
119                                               -1879.14        
122                                                    NaN        
150                                                    NaN        
153                                                    NaN        
162                                                    NaN        
...                                                    ...        
549882                                                 NaN        
549915                                                 NaN        
549937                                            -3612.55        
549963                                                 NaN        
549989                                            -2169.98        

         preIRA_mp8_cooking_total_npv_moreWTP_healthOnly_ap2_h6c  \
bldg_id                                                            
119                                                -806.60         
122                                                    NaN         
150                                                    NaN         
153                                                    NaN         
162                                                    NaN         
...                                                    ...         
549882                                                 NaN         
549915                                                 NaN         
549937                                            -2540.01         
549963                                                 NaN         
549989                                            -1097.44         

        preIRA_mp8_cooking_adoption_healthOnly_ap2_h6c  \
bldg_id                                                  
119                                     Tier 4: Averse   
122                                                NaN   
150                                                NaN   
153                                                NaN   
162                                                NaN   
...                                                ...   
549882                                             NaN   
549915                                             NaN   
549937                                  Tier 4: Averse   
549963                                             NaN   
549989                                  Tier 4: Averse   

        preIRA_mp8_cooking_impact_healthOnly_ap2_h6c  
bldg_id                                               
119                                 Public Detriment  
122                                              NaN  
150                                              NaN  
153                                              NaN  
162                                              NaN  
...                                              ...  
549882                                           NaN  
549915                                           NaN  
549937                              Public Detriment  
549963                                           NaN  
549989                              Public Detriment  

[15651 rows x 802 columns]

-----------------------------------------------
EASIUR:
-----------------------------------------------

         square_footage census_region  census_division census_division_recs  \
bldg_id                                                                       
119              2152.0     Northeast  Middle Atlantic      Middle Atlantic   
122              2176.0     Northeast  Middle Atlantic      Middle Atlantic   
150              1690.0     Northeast  Middle Atlantic      Middle Atlantic   
153              2176.0     Northeast  Middle Atlantic      Middle Atlantic   
162              2663.0     Northeast  Middle Atlantic      Middle Atlantic   
...                 ...           ...              ...                  ...   
549882           1202.0     Northeast  Middle Atlantic      Middle Atlantic   
549915           2176.0     Northeast  Middle Atlantic      Middle Atlantic   
549937            885.0     Northeast  Middle Atlantic      Middle Atlantic   
549963           1690.0     Northeast  Middle Atlantic      Middle Atlantic   
549989           1220.0     Northeast  Middle Atlantic      Middle Atlantic   

        building_america_climate_zone  reeds_balancing_area gea_region state  \
bldg_id                                                                        
119                       Mixed-Humid                   122      RFCEc    PA   
122                       Mixed-Humid                   122      RFCEc    PA   
150                              Cold                   122      RFCEc    PA   
153                       Mixed-Humid                   122      RFCEc    PA   
162                       Mixed-Humid                   122      RFCEc    PA   
...                               ...                   ...        ...   ...   
549882                           Cold                   122      RFCEc    PA   
549915                           Cold                   122      RFCEc    PA   
549937                           Cold                   115      RFCWc    PA   
549963                           Cold                   115      RFCWc    PA   
549989                           Cold                   122      RFCEc    PA   

                            city    county  ...  \
bldg_id                                     ...   
119        Not in a census Place  G4200450  ...   
122      In another census Place  G4200450  ...   
150      In another census Place  G4201190  ...   
153        Not in a census Place  G4200170  ...   
162        Not in a census Place  G4200450  ...   
...                          ...       ...  ...   
549882     Not in a census Place  G4200110  ...   
549915                 Lancaster  G4200710  ...   
549937   In another census Place  G4200050  ...   
549963   In another census Place  G4201290  ...   
549989     Not in a census Place  G4201110  ...   

        preIRA_mp8_cooking_health_sensitivity  \
bldg_id                                         
119                               easiur, h6c   
122                                       NaN   
150                                       NaN   
153                                       NaN   
162                                       NaN   
...                                       ...   
549882                                    NaN   
549915                                    NaN   
549937                            easiur, h6c   
549963                                    NaN   
549989                            easiur, h6c   

        preIRA_mp8_cooking_benefit_upper_easiur_h6c  \
bldg_id                                               
119                                             0.0   
122                                             NaN   
150                                             NaN   
153                                             NaN   
162                                             NaN   
...                                             ...   
549882                                          NaN   
549915                                          NaN   
549937                                          0.0   
549963                                          NaN   
549989                                          0.0   

        preIRA_mp8_cooking_total_npv_lessWTP_upper_easiur_h6c  \
bldg_id                                                         
119                                               -1562.56      
122                                                    NaN      
150                                                    NaN      
153                                                    NaN      
162                                                    NaN      
...                                                    ...      
549882                                                 NaN      
549915                                                 NaN      
549937                                            -3447.43      
549963                                                 NaN      
549989                                            -1693.37      

        preIRA_mp8_cooking_total_npv_moreWTP_upper_easiur_h6c  \
bldg_id                                                         
119                                                -490.02      
122                                                    NaN      
150                                                    NaN      
153                                                    NaN      
162                                                    NaN      
...                                                    ...      
549882                                                 NaN      
549915                                                 NaN      
549937                                            -2374.89      
549963                                                 NaN      
549989                                             -620.83      

         preIRA_mp8_cooking_adoption_upper_easiur_h6c  \
bldg_id                                                 
119                                    Tier 4: Averse   
122                                               NaN   
150                                               NaN   
153                                               NaN   
162                                               NaN   
...                                               ...   
549882                                            NaN   
549915                                            NaN   
549937                                 Tier 4: Averse   
549963                                            NaN   
549989                                 Tier 4: Averse   

         preIRA_mp8_cooking_impact_upper_easiur_h6c  \
bldg_id                                               
119                                Public Detriment   
122                                             NaN   
150                                             NaN   
153                                             NaN   
162                                             NaN   
...                                             ...   
549882                                          NaN   
549915                                          NaN   
549937                               Public Benefit   
549963                                          NaN   
549989                               Public Benefit   

        preIRA_mp8_cooking_total_npv_lessWTP_healthOnly_easiur_h6c  \
bldg_id                                                              
119                                               -1716.80           
122                                                    NaN           
150                                                    NaN           
153                                                    NaN           
162                                                    NaN           
...                                                    ...           
549882                                                 NaN           
549915                                                 NaN           
549937                                            -3549.58           
549963                                                 NaN           
549989                                            -2063.50           

         preIRA_mp8_cooking_total_npv_moreWTP_healthOnly_easiur_h6c  \
bldg_id                                                               
119                                                -644.26            
122                                                    NaN            
150                                                    NaN            
153                                                    NaN            
162                                                    NaN            
...                                                    ...            
549882                                                 NaN            
549915                                                 NaN            
549937                                            -2477.04            
549963                                                 NaN            
549989                                             -990.96            

        preIRA_mp8_cooking_adoption_healthOnly_easiur_h6c  \
bldg_id                                                     
119                                        Tier 4: Averse   
122                                                   NaN   
150                                                   NaN   
153                                                   NaN   
162                                                   NaN   
...                                                   ...   
549882                                                NaN   
549915                                                NaN   
549937                                     Tier 4: Averse   
549963                                                NaN   
549989                                     Tier 4: Averse   

        preIRA_mp8_cooking_impact_healthOnly_easiur_h6c  
bldg_id                                                  
119                                    Public Detriment  
122                                                 NaN  
150                                                 NaN  
153                                                 NaN  
162                                                 NaN  
...                                                 ...  
549882                                              NaN  
549915                                              NaN  
549937                                 Public Detriment  
549963                                              NaN  
549989                                 Public Detriment  

[15651 rows x 802 columns]

-----------------------------------------------
InMAP:
-----------------------------------------------

         square_footage census_region  census_division census_division_recs  \
bldg_id                                                                       
119              2152.0     Northeast  Middle Atlantic      Middle Atlantic   
122              2176.0     Northeast  Middle Atlantic      Middle Atlantic   
150              1690.0     Northeast  Middle Atlantic      Middle Atlantic   
153              2176.0     Northeast  Middle Atlantic      Middle Atlantic   
162              2663.0     Northeast  Middle Atlantic      Middle Atlantic   
...                 ...           ...              ...                  ...   
549882           1202.0     Northeast  Middle Atlantic      Middle Atlantic   
549915           2176.0     Northeast  Middle Atlantic      Middle Atlantic   
549937            885.0     Northeast  Middle Atlantic      Middle Atlantic   
549963           1690.0     Northeast  Middle Atlantic      Middle Atlantic   
549989           1220.0     Northeast  Middle Atlantic      Middle Atlantic   

        building_america_climate_zone  reeds_balancing_area gea_region state  \
bldg_id                                                                        
119                       Mixed-Humid                   122      RFCEc    PA   
122                       Mixed-Humid                   122      RFCEc    PA   
150                              Cold                   122      RFCEc    PA   
153                       Mixed-Humid                   122      RFCEc    PA   
162                       Mixed-Humid                   122      RFCEc    PA   
...                               ...                   ...        ...   ...   
549882                           Cold                   122      RFCEc    PA   
549915                           Cold                   122      RFCEc    PA   
549937                           Cold                   115      RFCWc    PA   
549963                           Cold                   115      RFCWc    PA   
549989                           Cold                   122      RFCEc    PA   

                            city    county  ...  \
bldg_id                                     ...   
119        Not in a census Place  G4200450  ...   
122      In another census Place  G4200450  ...   
150      In another census Place  G4201190  ...   
153        Not in a census Place  G4200170  ...   
162        Not in a census Place  G4200450  ...   
...                          ...       ...  ...   
549882     Not in a census Place  G4200110  ...   
549915                 Lancaster  G4200710  ...   
549937   In another census Place  G4200050  ...   
549963   In another census Place  G4201290  ...   
549989     Not in a census Place  G4201110  ...   

        preIRA_mp8_cooking_health_sensitivity  \
bldg_id                                         
119                                inmap, h6c   
122                                       NaN   
150                                       NaN   
153                                       NaN   
162                                       NaN   
...                                       ...   
549882                                    NaN   
549915                                    NaN   
549937                             inmap, h6c   
549963                                    NaN   
549989                             inmap, h6c   

        preIRA_mp8_cooking_benefit_upper_inmap_h6c  \
bldg_id                                              
119                                            0.0   
122                                            NaN   
150                                            NaN   
153                                            NaN   
162                                            NaN   
...                                            ...   
549882                                         NaN   
549915                                         NaN   
549937                                         0.0   
549963                                         NaN   
549989                                         0.0   

        preIRA_mp8_cooking_total_npv_lessWTP_upper_inmap_h6c  \
bldg_id                                                        
119                                               -1345.03     
122                                                    NaN     
150                                                    NaN     
153                                                    NaN     
162                                                    NaN     
...                                                    ...     
549882                                                 NaN     
549915                                                 NaN     
549937                                            -3506.50     
549963                                                 NaN     
549989                                            -1778.30     

        preIRA_mp8_cooking_total_npv_moreWTP_upper_inmap_h6c  \
bldg_id                                                        
119                                                -272.49     
122                                                    NaN     
150                                                    NaN     
153                                                    NaN     
162                                                    NaN     
...                                                    ...     
549882                                                 NaN     
549915                                                 NaN     
549937                                            -2433.96     
549963                                                 NaN     
549989                                             -705.76     

         preIRA_mp8_cooking_adoption_upper_inmap_h6c  \
bldg_id                                                
119                                   Tier 4: Averse   
122                                              NaN   
150                                              NaN   
153                                              NaN   
162                                              NaN   
...                                              ...   
549882                                           NaN   
549915                                           NaN   
549937                                Tier 4: Averse   
549963                                           NaN   
549989                                Tier 4: Averse   

         preIRA_mp8_cooking_impact_upper_inmap_h6c  \
bldg_id                                              
119                                 Public Benefit   
122                                            NaN   
150                                            NaN   
153                                            NaN   
162                                            NaN   
...                                            ...   
549882                                         NaN   
549915                                         NaN   
549937                            Public Detriment   
549963                                         NaN   
549989                              Public Benefit   

        preIRA_mp8_cooking_total_npv_lessWTP_healthOnly_inmap_h6c  \
bldg_id                                                             
119                                               -1499.27          
122                                                    NaN          
150                                                    NaN          
153                                                    NaN          
162                                                    NaN          
...                                                    ...          
549882                                                 NaN          
549915                                                 NaN          
549937                                            -3608.65          
549963                                                 NaN          
549989                                            -2148.43          

         preIRA_mp8_cooking_total_npv_moreWTP_healthOnly_inmap_h6c  \
bldg_id                                                              
119                                                -426.73           
122                                                    NaN           
150                                                    NaN           
153                                                    NaN           
162                                                    NaN           
...                                                    ...           
549882                                                 NaN           
549915                                                 NaN           
549937                                            -2536.11           
549963                                                 NaN           
549989                                            -1075.89           

        preIRA_mp8_cooking_adoption_healthOnly_inmap_h6c  \
bldg_id                                                    
119                                       Tier 4: Averse   
122                                                  NaN   
150                                                  NaN   
153                                                  NaN   
162                                                  NaN   
...                                                  ...   
549882                                               NaN   
549915                                               NaN   
549937                                    Tier 4: Averse   
549963                                               NaN   
549989                                    Tier 4: Averse   

        preIRA_mp8_cooking_impact_healthOnly_inmap_h6c  
bldg_id                                                 
119                                     Public Benefit  
122                                                NaN  
150                                                NaN  
153                                                NaN  
162                                                NaN  
...                                                ...  
549882                                             NaN  
549915                                             NaN  
549937                                Public Detriment  
549963                                             NaN  
549989                                Public Detriment  

[15651 rows x 802 columns]




# =========================================================================================
# SCENARIO ANALYSIS (AEO2023 REFERENCE CASE): ADOPTION POTENTIAL
# =========================================================================================


========================================================================================= FUNCTION CALL =========================================================================================


# ========================== AP2  ========================== 
df_euss_am_mp8_home_ap2 = adoption_decision(
    df=df_euss_am_mp8_home_ap2,
    menu_mp=menu_mp,
    policy_scenario='AEO2023 Reference Case',
    rcm_model='ap2',
    cr_function='acs',
    )

df_euss_am_mp8_home_ap2 = adoption_decision(
    df=df_euss_am_mp8_home_ap2,
    menu_mp=menu_mp,
    policy_scenario='AEO2023 Reference Case',
    rcm_model='ap2',
    cr_function='h6c',
    )

# ====================== EASIUR ========================== 
df_euss_am_mp8_home_easiur = adoption_decision(
    df=df_euss_am_mp8_home_easiur,
    menu_mp=menu_mp,
    policy_scenario='AEO2023 Reference Case',
    rcm_model='easiur',
    cr_function='acs',
    )

df_euss_am_mp8_home_easiur = adoption_decision(
    df=df_euss_am_mp8_home_easiur,
    menu_mp=menu_mp,
    policy_scenario='AEO2023 Reference Case',
    rcm_model='easiur',
    cr_function='h6c',
    )

# ====================== InMAP ========================== 
df_euss_am_mp8_home_inmap = adoption_decision(
    df=df_euss_am_mp8_home_inmap,
    menu_mp=menu_mp,
    policy_scenario='AEO2023 Reference Case',
    rcm_model='inmap',
    cr_function='acs',
    )

df_euss_am_mp8_home_inmap = adoption_decision(
    df=df_euss_am_mp8_home_inmap,
    menu_mp=menu_mp,
    policy_scenario='AEO2023 Reference Case',
    rcm_model='inmap',
    cr_function='h6c',
    )


print(f"""
====================================================================================================================================================================
DATAFRAME FOR MP8 AFTER DETERMINING ADOPTION FEASIBILITY (AEO2023 REFERENCE CASE): df_euss_am_mp8_home

-----------------------------------------------   
AP2: 
-----------------------------------------------
      
{df_euss_am_mp8_home_ap2}

-----------------------------------------------
EASIUR:
-----------------------------------------------

{df_euss_am_mp8_home_easiur}

-----------------------------------------------
InMAP:
-----------------------------------------------

{df_euss_am_mp8_home_inmap}
      
""")



========================================================================================= OUTPUT =========================================================================================



====================================================================================================================================================================
SCENARIO ANALYSIS (AEO2023 REFERENCE CASE): ADOPTION POTENTIAL
====================================================================================================================================================================
determine_adoption_potential.py file contains the definition for the adoption_decision function.
      
RESULTS OUTPUT (AEO2023 REFERENCE CASE):

-- Scenario: Inflation Reduction Act (IRA) Reference -- 
              scenario_prefix: 'iraRef_mp8_', cambium_scenario: 'MidCase', lookup_emissions_fossil_fuel: 'lookup_emissions_fossil_fuel', 
              lookup_emissions_electricity_climate: 'lookup_emissions_electricity_climate_IRA', lookup_emissions_electricity_health: 'lookup_emissions_electricity_health', lookup_fuel_prices: 'lookup_fuel_prices_iraRef'
              

Calculating Adoption Potential for heating under 'AEO2023 Reference Case' Scenario...
Measure package calculation for heating:
  - 12266 homes have valid data
  - 15649 homes will receive retrofits
  - 12266 homes have both valid data AND will receive retrofits
  - 3385 homes excluded (values will be NaN)
Found 12266 valid homes out of 15651 for heating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_heating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_heating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_heating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs

Calculating Adoption Potential for waterHeating under 'AEO2023 Reference Case' Scenario...
Measure package calculation for waterHeating:
  - 14999 homes have valid data
  - 15551 homes will receive retrofits
  - 14999 homes have both valid data AND will receive retrofits
  - 652 homes excluded (values will be NaN)
Found 14999 valid homes out of 15651 for waterHeating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_waterHeating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_waterHeating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_waterHeating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs

Calculating Adoption Potential for clothesDrying under 'AEO2023 Reference Case' Scenario...
Measure package calculation for clothesDrying:
  - 14743 homes have valid data
  - 14743 homes will receive retrofits
  - 14743 homes have both valid data AND will receive retrofits
  - 908 homes excluded (values will be NaN)
Found 14743 valid homes out of 15651 for clothesDrying adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_clothesDrying_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_clothesDrying_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_clothesDrying_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs

Calculating Adoption Potential for cooking under 'AEO2023 Reference Case' Scenario...
Measure package calculation for cooking:
  - 7867 homes have valid data
  - 7867 homes will receive retrofits
  - 7867 homes have both valid data AND will receive retrofits
  - 7784 homes excluded (values will be NaN)
Found 7867 valid homes out of 15651 for cooking adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_cooking_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_cooking_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_cooking_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_acs

Verifying masking for all calculated columns:
Masking 120 columns for category 'cooking'
    iraRef_mp8_cooking_health_sensitivity: Masked 7784 values
    iraRef_mp8_cooking_adoption_lower_ap2_acs: Masked 7784 values
    iraRef_mp8_cooking_impact_lower_ap2_acs: Masked 7784 values
    iraRef_mp8_cooking_adoption_healthOnly_ap2_acs: Masked 7784 values
    iraRef_mp8_cooking_impact_healthOnly_ap2_acs: Masked 7784 values
    iraRef_mp8_cooking_adoption_central_ap2_acs: Masked 7784 values
    iraRef_mp8_cooking_impact_central_ap2_acs: Masked 7784 values
    iraRef_mp8_cooking_adoption_upper_ap2_acs: Masked 7784 values
    iraRef_mp8_cooking_impact_upper_ap2_acs: Masked 7784 values
  Total: Masked 70056 values across 120 columns
-- Scenario: Inflation Reduction Act (IRA) Reference -- 
              scenario_prefix: 'iraRef_mp8_', cambium_scenario: 'MidCase', lookup_emissions_fossil_fuel: 'lookup_emissions_fossil_fuel', 
              lookup_emissions_electricity_climate: 'lookup_emissions_electricity_climate_IRA', lookup_emissions_electricity_health: 'lookup_emissions_electricity_health', lookup_fuel_prices: 'lookup_fuel_prices_iraRef'
              

Calculating Adoption Potential for heating under 'AEO2023 Reference Case' Scenario...
Measure package calculation for heating:
  - 12266 homes have valid data
  - 15649 homes will receive retrofits
  - 12266 homes have both valid data AND will receive retrofits
  - 3385 homes excluded (values will be NaN)
Found 12266 valid homes out of 15651 for heating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_heating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_heating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_heating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c

Calculating Adoption Potential for waterHeating under 'AEO2023 Reference Case' Scenario...
Measure package calculation for waterHeating:
  - 14999 homes have valid data
  - 15551 homes will receive retrofits
  - 14999 homes have both valid data AND will receive retrofits
  - 652 homes excluded (values will be NaN)
Found 14999 valid homes out of 15651 for waterHeating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_waterHeating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_waterHeating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_waterHeating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c

Calculating Adoption Potential for clothesDrying under 'AEO2023 Reference Case' Scenario...
Measure package calculation for clothesDrying:
  - 14743 homes have valid data
  - 14743 homes will receive retrofits
  - 14743 homes have both valid data AND will receive retrofits
  - 908 homes excluded (values will be NaN)
Found 14743 valid homes out of 15651 for clothesDrying adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_clothesDrying_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_clothesDrying_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_clothesDrying_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c

Calculating Adoption Potential for cooking under 'AEO2023 Reference Case' Scenario...
Measure package calculation for cooking:
  - 7867 homes have valid data
  - 7867 homes will receive retrofits
  - 7867 homes have both valid data AND will receive retrofits
  - 7784 homes excluded (values will be NaN)
Found 7867 valid homes out of 15651 for cooking adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_cooking_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_cooking_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_cooking_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for ap2_h6c

Verifying masking for all calculated columns:
Masking 120 columns for category 'cooking'
    iraRef_mp8_cooking_health_sensitivity: Masked 7784 values
    iraRef_mp8_cooking_adoption_lower_ap2_h6c: Masked 7784 values
    iraRef_mp8_cooking_impact_lower_ap2_h6c: Masked 7784 values
    iraRef_mp8_cooking_adoption_healthOnly_ap2_h6c: Masked 7784 values
    iraRef_mp8_cooking_impact_healthOnly_ap2_h6c: Masked 7784 values
    iraRef_mp8_cooking_adoption_central_ap2_h6c: Masked 7784 values
    iraRef_mp8_cooking_impact_central_ap2_h6c: Masked 7784 values
    iraRef_mp8_cooking_adoption_upper_ap2_h6c: Masked 7784 values
    iraRef_mp8_cooking_impact_upper_ap2_h6c: Masked 7784 values
  Total: Masked 70056 values across 120 columns
-- Scenario: Inflation Reduction Act (IRA) Reference -- 
              scenario_prefix: 'iraRef_mp8_', cambium_scenario: 'MidCase', lookup_emissions_fossil_fuel: 'lookup_emissions_fossil_fuel', 
              lookup_emissions_electricity_climate: 'lookup_emissions_electricity_climate_IRA', lookup_emissions_electricity_health: 'lookup_emissions_electricity_health', lookup_fuel_prices: 'lookup_fuel_prices_iraRef'
              

Calculating Adoption Potential for heating under 'AEO2023 Reference Case' Scenario...
Measure package calculation for heating:
  - 12266 homes have valid data
  - 15649 homes will receive retrofits
  - 12266 homes have both valid data AND will receive retrofits
  - 3385 homes excluded (values will be NaN)
Found 12266 valid homes out of 15651 for heating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_heating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_heating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_heating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs

Calculating Adoption Potential for waterHeating under 'AEO2023 Reference Case' Scenario...
Measure package calculation for waterHeating:
  - 14999 homes have valid data
  - 15551 homes will receive retrofits
  - 14999 homes have both valid data AND will receive retrofits
  - 652 homes excluded (values will be NaN)
Found 14999 valid homes out of 15651 for waterHeating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_waterHeating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_waterHeating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_waterHeating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs

Calculating Adoption Potential for clothesDrying under 'AEO2023 Reference Case' Scenario...
Measure package calculation for clothesDrying:
  - 14743 homes have valid data
  - 14743 homes will receive retrofits
  - 14743 homes have both valid data AND will receive retrofits
  - 908 homes excluded (values will be NaN)
Found 14743 valid homes out of 15651 for clothesDrying adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_clothesDrying_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_clothesDrying_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_clothesDrying_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs

Calculating Adoption Potential for cooking under 'AEO2023 Reference Case' Scenario...
Measure package calculation for cooking:
  - 7867 homes have valid data
  - 7867 homes will receive retrofits
  - 7867 homes have both valid data AND will receive retrofits
  - 7784 homes excluded (values will be NaN)
Found 7867 valid homes out of 15651 for cooking adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_cooking_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_cooking_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_cooking_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_acs

Verifying masking for all calculated columns:
Masking 120 columns for category 'cooking'
    iraRef_mp8_cooking_health_sensitivity: Masked 7784 values
    iraRef_mp8_cooking_adoption_lower_easiur_acs: Masked 7784 values
    iraRef_mp8_cooking_impact_lower_easiur_acs: Masked 7784 values
    iraRef_mp8_cooking_adoption_healthOnly_easiur_acs: Masked 7784 values
    iraRef_mp8_cooking_impact_healthOnly_easiur_acs: Masked 7784 values
    iraRef_mp8_cooking_adoption_central_easiur_acs: Masked 7784 values
    iraRef_mp8_cooking_impact_central_easiur_acs: Masked 7784 values
    iraRef_mp8_cooking_adoption_upper_easiur_acs: Masked 7784 values
    iraRef_mp8_cooking_impact_upper_easiur_acs: Masked 7784 values
  Total: Masked 70056 values across 120 columns
-- Scenario: Inflation Reduction Act (IRA) Reference -- 
              scenario_prefix: 'iraRef_mp8_', cambium_scenario: 'MidCase', lookup_emissions_fossil_fuel: 'lookup_emissions_fossil_fuel', 
              lookup_emissions_electricity_climate: 'lookup_emissions_electricity_climate_IRA', lookup_emissions_electricity_health: 'lookup_emissions_electricity_health', lookup_fuel_prices: 'lookup_fuel_prices_iraRef'
              

Calculating Adoption Potential for heating under 'AEO2023 Reference Case' Scenario...
Measure package calculation for heating:
  - 12266 homes have valid data
  - 15649 homes will receive retrofits
  - 12266 homes have both valid data AND will receive retrofits
  - 3385 homes excluded (values will be NaN)
Found 12266 valid homes out of 15651 for heating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_heating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_heating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_heating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c

Calculating Adoption Potential for waterHeating under 'AEO2023 Reference Case' Scenario...
Measure package calculation for waterHeating:
  - 14999 homes have valid data
  - 15551 homes will receive retrofits
  - 14999 homes have both valid data AND will receive retrofits
  - 652 homes excluded (values will be NaN)
Found 14999 valid homes out of 15651 for waterHeating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_waterHeating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_waterHeating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_waterHeating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c

Calculating Adoption Potential for clothesDrying under 'AEO2023 Reference Case' Scenario...
Measure package calculation for clothesDrying:
  - 14743 homes have valid data
  - 14743 homes will receive retrofits
  - 14743 homes have both valid data AND will receive retrofits
  - 908 homes excluded (values will be NaN)
Found 14743 valid homes out of 15651 for clothesDrying adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_clothesDrying_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_clothesDrying_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_clothesDrying_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c

Calculating Adoption Potential for cooking under 'AEO2023 Reference Case' Scenario...
Measure package calculation for cooking:
  - 7867 homes have valid data
  - 7867 homes will receive retrofits
  - 7867 homes have both valid data AND will receive retrofits
  - 7784 homes excluded (values will be NaN)
Found 7867 valid homes out of 15651 for cooking adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_cooking_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_cooking_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_cooking_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for easiur_h6c

Verifying masking for all calculated columns:
Masking 120 columns for category 'cooking'
    iraRef_mp8_cooking_health_sensitivity: Masked 7784 values
    iraRef_mp8_cooking_adoption_lower_easiur_h6c: Masked 7784 values
    iraRef_mp8_cooking_impact_lower_easiur_h6c: Masked 7784 values
    iraRef_mp8_cooking_adoption_healthOnly_easiur_h6c: Masked 7784 values
    iraRef_mp8_cooking_impact_healthOnly_easiur_h6c: Masked 7784 values
    iraRef_mp8_cooking_adoption_central_easiur_h6c: Masked 7784 values
    iraRef_mp8_cooking_impact_central_easiur_h6c: Masked 7784 values
    iraRef_mp8_cooking_adoption_upper_easiur_h6c: Masked 7784 values
    iraRef_mp8_cooking_impact_upper_easiur_h6c: Masked 7784 values
  Total: Masked 70056 values across 120 columns
-- Scenario: Inflation Reduction Act (IRA) Reference -- 
              scenario_prefix: 'iraRef_mp8_', cambium_scenario: 'MidCase', lookup_emissions_fossil_fuel: 'lookup_emissions_fossil_fuel', 
              lookup_emissions_electricity_climate: 'lookup_emissions_electricity_climate_IRA', lookup_emissions_electricity_health: 'lookup_emissions_electricity_health', lookup_fuel_prices: 'lookup_fuel_prices_iraRef'
              

Calculating Adoption Potential for heating under 'AEO2023 Reference Case' Scenario...
Measure package calculation for heating:
  - 12266 homes have valid data
  - 15649 homes will receive retrofits
  - 12266 homes have both valid data AND will receive retrofits
  - 3385 homes excluded (values will be NaN)
Found 12266 valid homes out of 15651 for heating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_heating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_heating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_heating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs

Calculating Adoption Potential for waterHeating under 'AEO2023 Reference Case' Scenario...
Measure package calculation for waterHeating:
  - 14999 homes have valid data
  - 15551 homes will receive retrofits
  - 14999 homes have both valid data AND will receive retrofits
  - 652 homes excluded (values will be NaN)
Found 14999 valid homes out of 15651 for waterHeating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_waterHeating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_waterHeating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_waterHeating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs

Calculating Adoption Potential for clothesDrying under 'AEO2023 Reference Case' Scenario...
Measure package calculation for clothesDrying:
  - 14743 homes have valid data
  - 14743 homes will receive retrofits
  - 14743 homes have both valid data AND will receive retrofits
  - 908 homes excluded (values will be NaN)
Found 14743 valid homes out of 15651 for clothesDrying adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_clothesDrying_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_clothesDrying_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_clothesDrying_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs

Calculating Adoption Potential for cooking under 'AEO2023 Reference Case' Scenario...
Measure package calculation for cooking:
  - 7867 homes have valid data
  - 7867 homes will receive retrofits
  - 7867 homes have both valid data AND will receive retrofits
  - 7784 homes excluded (values will be NaN)
Found 7867 valid homes out of 15651 for cooking adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_cooking_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_cooking_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_cooking_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_acs

Verifying masking for all calculated columns:
Masking 120 columns for category 'cooking'
    iraRef_mp8_cooking_health_sensitivity: Masked 7784 values
    iraRef_mp8_cooking_adoption_lower_inmap_acs: Masked 7784 values
    iraRef_mp8_cooking_impact_lower_inmap_acs: Masked 7784 values
    iraRef_mp8_cooking_adoption_healthOnly_inmap_acs: Masked 7784 values
    iraRef_mp8_cooking_impact_healthOnly_inmap_acs: Masked 7784 values
    iraRef_mp8_cooking_adoption_central_inmap_acs: Masked 7784 values
    iraRef_mp8_cooking_impact_central_inmap_acs: Masked 7784 values
    iraRef_mp8_cooking_adoption_upper_inmap_acs: Masked 7784 values
    iraRef_mp8_cooking_impact_upper_inmap_acs: Masked 7784 values
  Total: Masked 70056 values across 120 columns
-- Scenario: Inflation Reduction Act (IRA) Reference -- 
              scenario_prefix: 'iraRef_mp8_', cambium_scenario: 'MidCase', lookup_emissions_fossil_fuel: 'lookup_emissions_fossil_fuel', 
              lookup_emissions_electricity_climate: 'lookup_emissions_electricity_climate_IRA', lookup_emissions_electricity_health: 'lookup_emissions_electricity_health', lookup_fuel_prices: 'lookup_fuel_prices_iraRef'
              

Calculating Adoption Potential for heating under 'AEO2023 Reference Case' Scenario...
Measure package calculation for heating:
  - 12266 homes have valid data
  - 15649 homes will receive retrofits
  - 12266 homes have both valid data AND will receive retrofits
  - 3385 homes excluded (values will be NaN)
Found 12266 valid homes out of 15651 for heating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_heating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_heating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_heating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c

Calculating Adoption Potential for waterHeating under 'AEO2023 Reference Case' Scenario...
Measure package calculation for waterHeating:
  - 14999 homes have valid data
  - 15551 homes will receive retrofits
  - 14999 homes have both valid data AND will receive retrofits
  - 652 homes excluded (values will be NaN)
Found 14999 valid homes out of 15651 for waterHeating adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_waterHeating_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_waterHeating_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_waterHeating_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c

Calculating Adoption Potential for clothesDrying under 'AEO2023 Reference Case' Scenario...
Measure package calculation for clothesDrying:
  - 14743 homes have valid data
  - 14743 homes will receive retrofits
  - 14743 homes have both valid data AND will receive retrofits
  - 908 homes excluded (values will be NaN)
Found 14743 valid homes out of 15651 for clothesDrying adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_clothesDrying_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_clothesDrying_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_clothesDrying_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c

Calculating Adoption Potential for cooking under 'AEO2023 Reference Case' Scenario...
Measure package calculation for cooking:
  - 7867 homes have valid data
  - 7867 homes will receive retrofits
  - 7867 homes have both valid data AND will receive retrofits
  - 7784 homes excluded (values will be NaN)
Found 7867 valid homes out of 15651 for cooking adoption potential
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_cooking_climate_npv_lower: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_cooking_climate_npv_central: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c
    Climate NPV column has invalid type: <class 'pandas.core.frame.DataFrame'>
    Climate-only validation failed: Failed to convert climate-only analysis columns to numeric: ['iraRef_mp8_cooking_climate_npv_upper: arg must be a list, tuple, 1-d array, or Series']
    Health-only analysis available for inmap_h6c

Verifying masking for all calculated columns:
Masking 120 columns for category 'cooking'
    iraRef_mp8_cooking_health_sensitivity: Masked 7784 values
    iraRef_mp8_cooking_adoption_lower_inmap_h6c: Masked 7784 values
    iraRef_mp8_cooking_impact_lower_inmap_h6c: Masked 7784 values
    iraRef_mp8_cooking_adoption_healthOnly_inmap_h6c: Masked 7784 values
    iraRef_mp8_cooking_impact_healthOnly_inmap_h6c: Masked 7784 values
    iraRef_mp8_cooking_adoption_central_inmap_h6c: Masked 7784 values
    iraRef_mp8_cooking_impact_central_inmap_h6c: Masked 7784 values
    iraRef_mp8_cooking_adoption_upper_inmap_h6c: Masked 7784 values
    iraRef_mp8_cooking_impact_upper_inmap_h6c: Masked 7784 values
  Total: Masked 70056 values across 120 columns

====================================================================================================================================================================
DATAFRAME FOR MP8 AFTER DETERMINING ADOPTION FEASIBILITY (AEO2023 REFERENCE CASE): df_euss_am_mp8_home

-----------------------------------------------   
AP2: 
-----------------------------------------------
      
         square_footage census_region  census_division census_division_recs  \
bldg_id                                                                       
119              2152.0     Northeast  Middle Atlantic      Middle Atlantic   
122              2176.0     Northeast  Middle Atlantic      Middle Atlantic   
150              1690.0     Northeast  Middle Atlantic      Middle Atlantic   
153              2176.0     Northeast  Middle Atlantic      Middle Atlantic   
162              2663.0     Northeast  Middle Atlantic      Middle Atlantic   
...                 ...           ...              ...                  ...   
549882           1202.0     Northeast  Middle Atlantic      Middle Atlantic   
549915           2176.0     Northeast  Middle Atlantic      Middle Atlantic   
549937            885.0     Northeast  Middle Atlantic      Middle Atlantic   
549963           1690.0     Northeast  Middle Atlantic      Middle Atlantic   
549989           1220.0     Northeast  Middle Atlantic      Middle Atlantic   

        building_america_climate_zone  reeds_balancing_area gea_region state  \
bldg_id                                                                        
119                       Mixed-Humid                   122      RFCEc    PA   
122                       Mixed-Humid                   122      RFCEc    PA   
150                              Cold                   122      RFCEc    PA   
153                       Mixed-Humid                   122      RFCEc    PA   
162                       Mixed-Humid                   122      RFCEc    PA   
...                               ...                   ...        ...   ...   
549882                           Cold                   122      RFCEc    PA   
549915                           Cold                   122      RFCEc    PA   
549937                           Cold                   115      RFCWc    PA   
549963                           Cold                   115      RFCWc    PA   
549989                           Cold                   122      RFCEc    PA   

                            city    county  ...  \
bldg_id                                     ...   
119        Not in a census Place  G4200450  ...   
122      In another census Place  G4200450  ...   
150      In another census Place  G4201190  ...   
153        Not in a census Place  G4200170  ...   
162        Not in a census Place  G4200450  ...   
...                          ...       ...  ...   
549882     Not in a census Place  G4200110  ...   
549915                 Lancaster  G4200710  ...   
549937   In another census Place  G4200050  ...   
549963   In another census Place  G4201290  ...   
549989     Not in a census Place  G4201110  ...   

        iraRef_mp8_cooking_health_sensitivity  \
bldg_id                                         
119                                  ap2, h6c   
122                                       NaN   
150                                       NaN   
153                                       NaN   
162                                       NaN   
...                                       ...   
549882                                    NaN   
549915                                    NaN   
549937                               ap2, h6c   
549963                                    NaN   
549989                               ap2, h6c   

        iraRef_mp8_cooking_benefit_upper_ap2_h6c  \
bldg_id                                            
119                                         0.00   
122                                          NaN   
150                                          NaN   
153                                          NaN   
162                                          NaN   
...                                          ...   
549882                                       NaN   
549915                                       NaN   
549937                                    173.83   
549963                                       NaN   
549989                                    329.48   

        iraRef_mp8_cooking_total_npv_lessWTP_upper_ap2_h6c  \
bldg_id                                                      
119                                                -918.91   
122                                                    NaN   
150                                                    NaN   
153                                                    NaN   
162                                                    NaN   
...                                                    ...   
549882                                                 NaN   
549915                                                 NaN   
549937                                            -3266.80   
549963                                                 NaN   
549989                                            -1594.08   

        iraRef_mp8_cooking_total_npv_moreWTP_upper_ap2_h6c  \
bldg_id                                                      
119                                                 153.63   
122                                                    NaN   
150                                                    NaN   
153                                                    NaN   
162                                                    NaN   
...                                                    ...   
549882                                                 NaN   
549915                                                 NaN   
549937                                            -2194.26   
549963                                                 NaN   
549989                                             -521.54   

         iraRef_mp8_cooking_adoption_upper_ap2_h6c  \
bldg_id                                              
119               Tier 2: Feasible vs. Alternative   
122                                            NaN   
150                                            NaN   
153                                            NaN   
162                                            NaN   
...                                            ...   
549882                                         NaN   
549915                                         NaN   
549937                              Tier 4: Averse   
549963                                         NaN   
549989                              Tier 4: Averse   

         iraRef_mp8_cooking_impact_upper_ap2_h6c  \
bldg_id                                            
119                               Public Benefit   
122                                          NaN   
150                                          NaN   
153                                          NaN   
162                                          NaN   
...                                          ...   
549882                                       NaN   
549915                                       NaN   
549937                            Public Benefit   
549963                                       NaN   
549989                            Public Benefit   

        iraRef_mp8_cooking_total_npv_lessWTP_healthOnly_ap2_h6c  \
bldg_id                                                           
119                                               -1299.38        
122                                                    NaN        
150                                                    NaN        
153                                                    NaN        
162                                                    NaN        
...                                                    ...        
549882                                                 NaN        
549915                                                 NaN        
549937                                            -3592.85        
549963                                                 NaN        
549989                                            -2157.59        

         iraRef_mp8_cooking_total_npv_moreWTP_healthOnly_ap2_h6c  \
bldg_id                                                            
119                                                -226.84         
122                                                    NaN         
150                                                    NaN         
153                                                    NaN         
162                                                    NaN         
...                                                    ...         
549882                                                 NaN         
549915                                                 NaN         
549937                                            -2520.31         
549963                                                 NaN         
549989                                            -1085.05         

        iraRef_mp8_cooking_adoption_healthOnly_ap2_h6c  \
bldg_id                                                  
119                   Tier 2: Feasible vs. Alternative   
122                                                NaN   
150                                                NaN   
153                                                NaN   
162                                                NaN   
...                                                ...   
549882                                             NaN   
549915                                             NaN   
549937                                  Tier 4: Averse   
549963                                             NaN   
549989                                  Tier 4: Averse   

        iraRef_mp8_cooking_impact_healthOnly_ap2_h6c  
bldg_id                                               
119                                 Public Detriment  
122                                              NaN  
150                                              NaN  
153                                              NaN  
162                                              NaN  
...                                              ...  
549882                                           NaN  
549915                                           NaN  
549937                              Public Detriment  
549963                                           NaN  
549989                              Public Detriment  

[15651 rows x 1030 columns]

-----------------------------------------------
EASIUR:
-----------------------------------------------

         square_footage census_region  census_division census_division_recs  \
bldg_id                                                                       
119              2152.0     Northeast  Middle Atlantic      Middle Atlantic   
122              2176.0     Northeast  Middle Atlantic      Middle Atlantic   
150              1690.0     Northeast  Middle Atlantic      Middle Atlantic   
153              2176.0     Northeast  Middle Atlantic      Middle Atlantic   
162              2663.0     Northeast  Middle Atlantic      Middle Atlantic   
...                 ...           ...              ...                  ...   
549882           1202.0     Northeast  Middle Atlantic      Middle Atlantic   
549915           2176.0     Northeast  Middle Atlantic      Middle Atlantic   
549937            885.0     Northeast  Middle Atlantic      Middle Atlantic   
549963           1690.0     Northeast  Middle Atlantic      Middle Atlantic   
549989           1220.0     Northeast  Middle Atlantic      Middle Atlantic   

        building_america_climate_zone  reeds_balancing_area gea_region state  \
bldg_id                                                                        
119                       Mixed-Humid                   122      RFCEc    PA   
122                       Mixed-Humid                   122      RFCEc    PA   
150                              Cold                   122      RFCEc    PA   
153                       Mixed-Humid                   122      RFCEc    PA   
162                       Mixed-Humid                   122      RFCEc    PA   
...                               ...                   ...        ...   ...   
549882                           Cold                   122      RFCEc    PA   
549915                           Cold                   122      RFCEc    PA   
549937                           Cold                   115      RFCWc    PA   
549963                           Cold                   115      RFCWc    PA   
549989                           Cold                   122      RFCEc    PA   

                            city    county  ...  \
bldg_id                                     ...   
119        Not in a census Place  G4200450  ...   
122      In another census Place  G4200450  ...   
150      In another census Place  G4201190  ...   
153        Not in a census Place  G4200170  ...   
162        Not in a census Place  G4200450  ...   
...                          ...       ...  ...   
549882     Not in a census Place  G4200110  ...   
549915                 Lancaster  G4200710  ...   
549937   In another census Place  G4200050  ...   
549963   In another census Place  G4201290  ...   
549989     Not in a census Place  G4201110  ...   

        iraRef_mp8_cooking_health_sensitivity  \
bldg_id                                         
119                               easiur, h6c   
122                                       NaN   
150                                       NaN   
153                                       NaN   
162                                       NaN   
...                                       ...   
549882                                    NaN   
549915                                    NaN   
549937                            easiur, h6c   
549963                                    NaN   
549989                            easiur, h6c   

        iraRef_mp8_cooking_benefit_upper_easiur_h6c  \
bldg_id                                               
119                                            0.00   
122                                             NaN   
150                                             NaN   
153                                             NaN   
162                                             NaN   
...                                             ...   
549882                                          NaN   
549915                                          NaN   
549937                                       236.80   
549963                                          NaN   
549989                                       435.96   

        iraRef_mp8_cooking_total_npv_lessWTP_upper_easiur_h6c  \
bldg_id                                                         
119                                                -756.57      
122                                                    NaN      
150                                                    NaN      
153                                                    NaN      
162                                                    NaN      
...                                                    ...      
549882                                                 NaN      
549915                                                 NaN      
549937                                            -3203.83      
549963                                                 NaN      
549989                                            -1487.60      

        iraRef_mp8_cooking_total_npv_moreWTP_upper_easiur_h6c  \
bldg_id                                                         
119                                                 315.97      
122                                                    NaN      
150                                                    NaN      
153                                                    NaN      
162                                                    NaN      
...                                                    ...      
549882                                                 NaN      
549915                                                 NaN      
549937                                            -2131.29      
549963                                                 NaN      
549989                                             -415.06      

         iraRef_mp8_cooking_adoption_upper_easiur_h6c  \
bldg_id                                                 
119                  Tier 2: Feasible vs. Alternative   
122                                               NaN   
150                                               NaN   
153                                               NaN   
162                                               NaN   
...                                               ...   
549882                                            NaN   
549915                                            NaN   
549937                                 Tier 4: Averse   
549963                                            NaN   
549989                                 Tier 4: Averse   

         iraRef_mp8_cooking_impact_upper_easiur_h6c  \
bldg_id                                               
119                                  Public Benefit   
122                                             NaN   
150                                             NaN   
153                                             NaN   
162                                             NaN   
...                                             ...   
549882                                          NaN   
549915                                          NaN   
549937                               Public Benefit   
549963                                          NaN   
549989                               Public Benefit   

        iraRef_mp8_cooking_total_npv_lessWTP_healthOnly_easiur_h6c  \
bldg_id                                                              
119                                               -1137.04           
122                                                    NaN           
150                                                    NaN           
153                                                    NaN           
162                                                    NaN           
...                                                    ...           
549882                                                 NaN           
549915                                                 NaN           
549937                                            -3529.88           
549963                                                 NaN           
549989                                            -2051.11           

         iraRef_mp8_cooking_total_npv_moreWTP_healthOnly_easiur_h6c  \
bldg_id                                                               
119                                                 -64.50            
122                                                    NaN            
150                                                    NaN            
153                                                    NaN            
162                                                    NaN            
...                                                    ...            
549882                                                 NaN            
549915                                                 NaN            
549937                                            -2457.34            
549963                                                 NaN            
549989                                             -978.57            

        iraRef_mp8_cooking_adoption_healthOnly_easiur_h6c  \
bldg_id                                                     
119                      Tier 2: Feasible vs. Alternative   
122                                                   NaN   
150                                                   NaN   
153                                                   NaN   
162                                                   NaN   
...                                                   ...   
549882                                                NaN   
549915                                                NaN   
549937                                     Tier 4: Averse   
549963                                                NaN   
549989                                     Tier 4: Averse   

        iraRef_mp8_cooking_impact_healthOnly_easiur_h6c  
bldg_id                                                  
119                                    Public Detriment  
122                                                 NaN  
150                                                 NaN  
153                                                 NaN  
162                                                 NaN  
...                                                 ...  
549882                                              NaN  
549915                                              NaN  
549937                                 Public Detriment  
549963                                              NaN  
549989                                 Public Detriment  

[15651 rows x 1030 columns]

-----------------------------------------------
InMAP:
-----------------------------------------------

         square_footage census_region  census_division census_division_recs  \
bldg_id                                                                       
119              2152.0     Northeast  Middle Atlantic      Middle Atlantic   
122              2176.0     Northeast  Middle Atlantic      Middle Atlantic   
150              1690.0     Northeast  Middle Atlantic      Middle Atlantic   
153              2176.0     Northeast  Middle Atlantic      Middle Atlantic   
162              2663.0     Northeast  Middle Atlantic      Middle Atlantic   
...                 ...           ...              ...                  ...   
549882           1202.0     Northeast  Middle Atlantic      Middle Atlantic   
549915           2176.0     Northeast  Middle Atlantic      Middle Atlantic   
549937            885.0     Northeast  Middle Atlantic      Middle Atlantic   
549963           1690.0     Northeast  Middle Atlantic      Middle Atlantic   
549989           1220.0     Northeast  Middle Atlantic      Middle Atlantic   

        building_america_climate_zone  reeds_balancing_area gea_region state  \
bldg_id                                                                        
119                       Mixed-Humid                   122      RFCEc    PA   
122                       Mixed-Humid                   122      RFCEc    PA   
150                              Cold                   122      RFCEc    PA   
153                       Mixed-Humid                   122      RFCEc    PA   
162                       Mixed-Humid                   122      RFCEc    PA   
...                               ...                   ...        ...   ...   
549882                           Cold                   122      RFCEc    PA   
549915                           Cold                   122      RFCEc    PA   
549937                           Cold                   115      RFCWc    PA   
549963                           Cold                   115      RFCWc    PA   
549989                           Cold                   122      RFCEc    PA   

                            city    county  ...  \
bldg_id                                     ...   
119        Not in a census Place  G4200450  ...   
122      In another census Place  G4200450  ...   
150      In another census Place  G4201190  ...   
153        Not in a census Place  G4200170  ...   
162        Not in a census Place  G4200450  ...   
...                          ...       ...  ...   
549882     Not in a census Place  G4200110  ...   
549915                 Lancaster  G4200710  ...   
549937   In another census Place  G4200050  ...   
549963   In another census Place  G4201290  ...   
549989     Not in a census Place  G4201110  ...   

        iraRef_mp8_cooking_health_sensitivity  \
bldg_id                                         
119                                inmap, h6c   
122                                       NaN   
150                                       NaN   
153                                       NaN   
162                                       NaN   
...                                       ...   
549882                                    NaN   
549915                                    NaN   
549937                             inmap, h6c   
549963                                    NaN   
549989                             inmap, h6c   

        iraRef_mp8_cooking_benefit_upper_inmap_h6c  \
bldg_id                                              
119                                           0.00   
122                                            NaN   
150                                            NaN   
153                                            NaN   
162                                            NaN   
...                                            ...   
549882                                         NaN   
549915                                         NaN   
549937                                      177.73   
549963                                         NaN   
549989                                      351.03   

        iraRef_mp8_cooking_total_npv_lessWTP_upper_inmap_h6c  \
bldg_id                                                        
119                                                -539.04     
122                                                    NaN     
150                                                    NaN     
153                                                    NaN     
162                                                    NaN     
...                                                    ...     
549882                                                 NaN     
549915                                                 NaN     
549937                                            -3262.90     
549963                                                 NaN     
549989                                            -1572.53     

        iraRef_mp8_cooking_total_npv_moreWTP_upper_inmap_h6c  \
bldg_id                                                        
119                                                 533.50     
122                                                    NaN     
150                                                    NaN     
153                                                    NaN     
162                                                    NaN     
...                                                    ...     
549882                                                 NaN     
549915                                                 NaN     
549937                                            -2190.36     
549963                                                 NaN     
549989                                             -499.99     

         iraRef_mp8_cooking_adoption_upper_inmap_h6c  \
bldg_id                                                
119                 Tier 2: Feasible vs. Alternative   
122                                              NaN   
150                                              NaN   
153                                              NaN   
162                                              NaN   
...                                              ...   
549882                                           NaN   
549915                                           NaN   
549937                                Tier 4: Averse   
549963                                           NaN   
549989                                Tier 4: Averse   

         iraRef_mp8_cooking_impact_upper_inmap_h6c  \
bldg_id                                              
119                                 Public Benefit   
122                                            NaN   
150                                            NaN   
153                                            NaN   
162                                            NaN   
...                                            ...   
549882                                         NaN   
549915                                         NaN   
549937                              Public Benefit   
549963                                         NaN   
549989                              Public Benefit   

        iraRef_mp8_cooking_total_npv_lessWTP_healthOnly_inmap_h6c  \
bldg_id                                                             
119                                                -919.51          
122                                                    NaN          
150                                                    NaN          
153                                                    NaN          
162                                                    NaN          
...                                                    ...          
549882                                                 NaN          
549915                                                 NaN          
549937                                            -3588.95          
549963                                                 NaN          
549989                                            -2136.04          

         iraRef_mp8_cooking_total_npv_moreWTP_healthOnly_inmap_h6c  \
bldg_id                                                              
119                                                 153.03           
122                                                    NaN           
150                                                    NaN           
153                                                    NaN           
162                                                    NaN           
...                                                    ...           
549882                                                 NaN           
549915                                                 NaN           
549937                                            -2516.41           
549963                                                 NaN           
549989                                            -1063.50           

        iraRef_mp8_cooking_adoption_healthOnly_inmap_h6c  \
bldg_id                                                    
119                     Tier 2: Feasible vs. Alternative   
122                                                  NaN   
150                                                  NaN   
153                                                  NaN   
162                                                  NaN   
...                                                  ...   
549882                                               NaN   
549915                                               NaN   
549937                                    Tier 4: Averse   
549963                                               NaN   
549989                                    Tier 4: Averse   

        iraRef_mp8_cooking_impact_healthOnly_inmap_h6c  
bldg_id                                                 
119                                     Public Benefit  
122                                                NaN  
150                                                NaN  
153                                                NaN  
162                                                NaN  
...                                                ...  
549882                                             NaN  
549915                                             NaN  
549937                                Public Detriment  
549963                                             NaN  
549989                                Public Detriment  

[15651 rows x 1030 columns]